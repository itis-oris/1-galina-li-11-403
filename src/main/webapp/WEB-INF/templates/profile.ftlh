<#import "base.ftlh" as layout>

<@layout.base pageTitle="–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å">
    <div style="max-width: 1200px; margin: 0 auto;">
        <nav style="margin-bottom: 1rem;">
            <a href="${contextPath}/events" class="btn" style="padding: 6px 12px;">‚Üê –í—Å–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è</a>
            <#if user??>
                <a href="${contextPath}/events/my" class="btn" style="padding: 6px 12px;">–ú–æ–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è</a>
            </#if>
        </nav>

        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 2rem;">
            <div>
                <div class="card">
                    <h3>üë§ –ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</h3>
                    <div style="text-align: center; margin-bottom: 1rem;">
                        <div style="font-size: 3rem; margin-bottom: 0.5rem;">üöó</div>
                        <h4>${user.username!''}</h4>
                        <p style="color: #666; font-size: 0.9em;">${user.email!''}</p>
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem; text-align: center;">
                        <div style="background: #e3f2fd; padding: 0.5rem; border-radius: 8px;">
                            <div style="font-size: 1.5em; font-weight: bold;">${userEvents?size!0}</div>
                            <div style="font-size: 0.8em;">–°–æ–∑–¥–∞–Ω–æ</div>
                        </div>
                        <div style="background: #e8f5e8; padding: 0.5rem; border-radius: 8px;">
                            <div style="font-size: 1.5em; font-weight: bold;">${registeredEvents?size!0}</div>
                            <div style="font-size: 0.8em;">–£—á–∞—Å—Ç–≤—É—é</div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h4>–ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h4>
                    <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                        <a href="${contextPath}/events/new" class="btn btn-success">–°–æ–∑–¥–∞—Ç—å –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ</a>
                        <a href="${contextPath}/cars" class="btn">–ú–æ–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏</a>
                        <a href="${contextPath}/auth/logout" class="btn" style="background: #95a5a6;">üö™ –í—ã–π—Ç–∏</a>
                    </div>
                </div>
            </div>

            <div>
                <div class="card" style="margin-bottom: 2rem;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                        <h3>üéØ –ú–æ–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è</h3>
                        <a href="${contextPath}/events/new" class="btn btn-success" style="padding: 6px 12px;">+ –°–æ–∑–¥–∞—Ç—å</a>
                    </div>

                    <#if userEvents?? && userEvents?size gt 0>
                        <div style="display: grid; gap: 1rem;">
                            <#list userEvents as event>
                                <div style="border: 1px solid #e9ecef; border-radius: 8px; padding: 1rem;">
                                    <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                                        <div style="flex: 1;">
                                            <h4 style="margin: 0 0 0.5rem 0;">${event.title!''}</h4>
                                            <p style="color: #666; margin: 0 0 0.5rem 0;">
                                                <#if event.eventDate??>
                                                    üìÖ ${event.eventDate.toString()}
                                                <#else>
                                                    üìÖ –î–∞—Ç–∞ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞
                                                </#if>
                                            </p>
                                            <p style="margin: 0; font-size: 0.9em;">
                                                üìç ${event.location!''}
                                            </p>
                                        </div>
                                        <div style="flex-shrink: 0; display: flex; gap: 0.5rem;">
                                            <a href="${contextPath}/events/${event.id}" class="btn" style="padding: 4px 8px; font-size: 0.8em;">
                                                üëÄ
                                            </a>
                                            <a href="${contextPath}/events/edit/${event.id}" class="btn" style="padding: 4px 8px; font-size: 0.8em;">
                                                ‚úèÔ∏è
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </#list>
                        </div>
                    <#else>
                        <div style="text-align: center; padding: 2rem; color: #6c757d;">
                            <div style="font-size: 3rem; margin-bottom: 1rem;">üì≠</div>
                            <p>–í—ã –µ—â–µ –Ω–µ —Å–æ–∑–¥–∞–ª–∏ –Ω–∏ –æ–¥–Ω–æ–≥–æ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è</p>
                            <a href="${contextPath}/events/new" class="btn btn-success">–°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤–æ–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ</a>
                        </div>
                    </#if>
                </div>

                <div class="card" style="margin-bottom: 2rem;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                        <h3>‚úÖ –£—á–∞—Å—Ç–≤—É—é –≤ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è—Ö</h3>
                    </div>

                    <#if registeredEvents?? && registeredEvents?size gt 0>
                        <div style="display: grid; gap: 1rem;">
                            <#list registeredEvents as event>
                                <div style="border: 1px solid #e9ecef; border-radius: 8px; padding: 1rem;">
                                    <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                                        <div style="flex: 1;">
                                            <h4 style="margin: 0 0 0.5rem 0;">${event.title!''}</h4>
                                            <p style="color: #666; margin: 0 0 0.5rem 0;">
                                                <#if event.eventDate??>
                                                    üìÖ ${event.eventDate.toString()}
                                                <#else>
                                                    üìÖ –î–∞—Ç–∞ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞
                                                </#if>
                                            </p>
                                            <p style="margin: 0; font-size: 0.9em;">
                                                üìç ${event.location!''}
                                            </p>
                                        </div>
                                        <div style="flex-shrink: 0;">
                                            <a href="${contextPath}/events/${event.id}" class="btn" style="padding: 4px 8px; font-size: 0.8em;">
                                                üëÄ –ü–æ–¥—Ä–æ–±–Ω–µ–µ
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </#list>
                        </div>
                    <#else>
                        <div style="text-align: center; padding: 2rem; color: #6c757d;">
                            <div style="font-size: 3rem; margin-bottom: 1rem;">üé™</div>
                            <p>–í—ã –µ—â–µ –Ω–µ –∑–∞–ø–∏—Å–∞–Ω—ã –Ω–∏ –Ω–∞ –æ–¥–Ω–æ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ</p>
                            <a href="${contextPath}/events" class="btn">–ù–∞–π—Ç–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è</a>
                        </div>
                    </#if>
                </div>

                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                        <h3>üöô –ú–æ–∏ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏</h3>
                        <a href="${contextPath}/cars/new" class="btn btn-success" style="padding: 6px 12px;">+ –î–æ–±–∞–≤–∏—Ç—å</a>
                    </div>

                    <#if userCars?? && userCars?size gt 0>
                        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 1rem;">
                            <#list userCars as car>
                                <div style="border: 1px solid #e9ecef; border-radius: 8px; padding: 1rem; text-align: center;">
                                    <div style="font-size: 2rem; margin-bottom: 0.5rem;">üöó</div>
                                    <h4 style="margin: 0 0 0.25rem 0;">${car.brand!''}</h4>
                                    <p style="margin: 0 0 0.25rem 0; color: #666;">${car.model!''}</p>
                                    <p style="margin: 0; font-size: 0.9em; color: #999;">${car.year!''} –≥–æ–¥</p>
                                </div>
                            </#list>
                        </div>
                    <#else>
                        <div style="text-align: center; padding: 2rem; color: #6c757d;">
                            <div style="font-size: 3rem; margin-bottom: 1rem;">üöô</div>
                            <p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π</p>
                            <a href="${contextPath}/cars/new" class="btn btn-success">–î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–≤—ã–π –∞–≤—Ç–æ–º–æ–±–∏–ª—å</a>
                        </div>
                    </#if>
                </div>
            </div>
        </div>
    </div>
</@layout.base>